#!/usr/bin/env python
#
# Importamos los modulos/librerias necesarias

from core.menu_texto_p import *
from vulnera.modulo.uso_banner import *
from vulnera.modulo.uso_nmap import *
from vulnera.modulo.uso_scapy import *
from core.funciones_core import *
from termcolor import colored

#########################################
#                                       #
# Menu de Analisis de Vulnerabilidades  #
# Escrito por: Daniel Gonzalez (DGM)    #
#                                       #
#########################################
#
# Parte principal


def analisis_de_vulnerabilidades():
    # Hacemos un bucle para volver al Menu Principal si no se elige una opcion predeterminada por nosotros
    while 1:
        try:
            # Llamamos al Banner pasandole la version de la aplicacion.
            show_banner(define_version, '1', 'vulnera')
            # Creamos un objeto de la clase Menu. Le pasamos el texto del fichero mitext.py con las opciones
            muestra_menu_principal = Crear_menu(texto_principal, menu_principal_vulnera)

            # Carga del Menu Principal manera Standard (sin nada especial)
            eleccion_menu_prin = input(colored("Elija una opcion: ", 'blue'))

            # Salir de la aplicacion
            if eleccion_menu_prin == 'exit' or eleccion_menu_prin == "99" or eleccion_menu_prin == "quit":
                break

            # Llama a la funcion para analasis de vulnerabilidades con scapy
            if eleccion_menu_prin == '1':
                analisis_scapy()

            # Llama a la funcion para analasis de vulnerabilidades con nmap
            if eleccion_menu_prin == '2':
                analisis_nmap()

            # Llama a la funcion para analasis de vulnerabilidades en Banner
            if eleccion_menu_prin == '3':
                analisisBanner()

            # Llama a la funcion vulrenabilidadHTTP
            if eleccion_menu_prin == '4':
                vulrenabilidadHTTP()

        # Capturamos una interrucion por teclado (Control+C)
        except KeyboardInterrupt:
            print(("\n\nGracias por " + bcolors.RED + "utilizar la herramineta" + bcolors.ENDC +
                   " Busca en Red.\n\nSeguimos trabajando en ello.\n"))
            # Salimos del bucle While
            break

        # Capturamos alguna excepcion ocurrida
        except Exception as error:
            print(error)
            print("\n\n[!] Algo fue mal, mostrando error por pantalla: " + str(error))
            input("Pulse INTRO para volver al Menu Principal.")
