#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
# Importamos los modulos/librerias necesarias
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

                            ANALIZANDO CON NESSUS

                BUSCANDO VULNERABILIDADES CON INFORME DE RESULTADOS

"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
from core.menu_texto_p import *
from nessus.mod_nessus.funciones_nessus import *
from nessus.mod_nessus.funciones_export import *
from core.funciones_core import *
from termcolor import colored


def analisis_con_nessus():
    while True:
        try:
            # Llamamos al Banner pasandole la version de la aplicacion.
            show_banner(define_version, '1', 'nessus')
            # Creamos un objeto de la clase Menu. Le pasamos el texto del fichero mitext.py con las opciones
            muestra_menu_principal = Crear_menu(texto_principal, menu_principal_nessus)

            # Carga del Menu Principal manera Standard (sin nada especial)
            eleccion_menu_prin = input(colored("Elija una opcion: ", 'blue'))

            # Salir de la aplicacion
            if eleccion_menu_prin == 'exit' or eleccion_menu_prin == "99" or eleccion_menu_prin == "quit":
                break

            # Llama a la funcion
            if eleccion_menu_prin == '1':
                escaneo_equipo_nessus()

            # Llama a la funcion para exportar los escaneos comletados a PDF.
            if eleccion_menu_prin == '2':
                exporta_escaneo_pdf()

            # Llama a la funcion para mostrar las directivas disponibles en Nessus.
            if eleccion_menu_prin == '3':
                listado_directivas()

        except:
            print(colored("Error en los datos introducidos.", 'red'))

